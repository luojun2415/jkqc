<extend name="Public/base"/><block name="body">    <!-- 标题 -->    <div class="main-title">        <h2>            {$title|htmlspecialchars}            <if condition="$suggest">（{$suggest|htmlspecialchars}）</if>        </h2>    </div>    <div class="with-padding">    <!-- 表格列表-->    <div class="tb-unit posr">        <div class="tb-unit-bar">            <volist name="buttonList" id="button">                <{$button.tag} {$button.attr} style="margin-right:5px;">{$button.title|htmlspecialchars}</{$button.tag}>            </volist>        </div>        <div class="category">            <div class="hd clearfix">                <div class="fold">{:L("_FOLD_")}</div>                <div class="order">{:L("_SORT_")}</div>                <volist name="keyList" id="field">                    <th>{$field.title|htmlspecialchars}</th>                </volist>                <div class="name">{:L("_NAME_")}</div>            </div><php>function treeList($list,&$nodehtml,$model){    if($list){        foreach($list as $data){            $nodehtml.='<dl class="cate-item"><dt class="clearfix"><form action="'.U('add'.$model).'" method="post">';            $nodehtml.='<div class="btn-toolbar opt-btn clearfix"><a title='            .L("_EDIT_WITH_DOUBLE_").'href="'.U('add'.$model.'?id='.$data['id'].'&pid='.$data['pid']).'">'.L("_EDIT_").'</a> <a title="'            .show_status_op($data['status']).'" href="'.U('set'.$model.'Status?ids='.$data['id'].'&status='.abs(1-$data['status'])).'" class="ajax-get">'        .show_status_op($data['status']).'</a> <a title='.L("_DELETE_WITH_DOUBLE_").'href="'.U('set'.$model.'Status?ids='.$data['id']        .'&status=-1').'" class="confirm ajax-get">'.L("_DELETE_").'</a></div>';            $nodehtml .= '<div class="fold"> <i class="icon-unfold"></i> </div><div class="order"><input type="text" name="sort" class="form-control text input-mini" value="'            .$data['sort'].'"></div>';            $nodehtml .= '<div class="name"><span class="tab-sign"></span><input type="hidden" name="id" value="'            .$data['id'].'"><input type="text" name="title" class="form-control text" style="width: 200px;display: inline-block" value="'.$data['title'].            '"><a class="add-sub-cate" title="'.L("_ADD_A_SUB_CATEGORY_WITH_DOUBLE_").'" href="'.U('add'.$model.'?pid='.$data['id'])                .'"><i class="icon-plus"></i></a><span class="help-inline msg"></span></div></form></dt>';            if($data['_']){                $nodehtml.='<dd>';                treeList($data['_'],$nodehtml,$model);                $nodehtml.='</dd>';            }            $nodehtml .='</dl>';        }    }    // dump($html);}$nodehtml;treeList($tree,$nodehtml,$model);echo $nodehtml;</php>            <!-- /表格列表-->            <!-- 分页 -->            <div class="page">                {$pagination}            </div>        </div>    </div></div></block><block name="script">    <script type="text/javascript">        $(function($){            /* 分类展开收起 */            // $(".category dd").prev().find(".fold i").addClass("icon-unfold");            $(".category dd").prev().find(".fold i")                // .addClass("icon-unfold")            .click(function(){                var self = $(this);                if(self.hasClass("icon-unfold")){                    self.closest("dt").next().slideUp("fast", function(){                        self.removeClass("icon-unfold").addClass("icon-fold");                    });                } else {                    self.closest("dt").next().slideDown("fast", function(){                        self.removeClass("icon-fold").addClass("icon-unfold");                    });                }            });            $(".category dd").prev().find(".fold i").each(function(){                	$(this).click();              });            /* 三级分类删除新增按钮 */            $(".category dd dd .add-sub").remove();            /* 实时更新分类信息 */            $(".category")                    .on("submit", "form", function(){                        var self = $(this);                        $.post(                                self.attr("action"),                                self.serialize(),                                function(data){                                    /* 提示信息 */                                    var name = data.status ? "success" : "error", msg;                                    msg = self.find(".msg").addClass(name).text(data.info)                                            .css("display", "inline-block");                                    setTimeout(function(){                                        msg.fadeOut(function(){                                            msg.text("").removeClass(name);                                        });                                    }, 1000);                                },                                "json"                        );                        return false;                    })                    .on("focus","input",function(){                        $(this).data('param',$(this).closest("form").serialize());                    })                    .on("blur", "input", function(){                        if($(this).data('param')!=$(this).closest("form").serialize()){                            $(this).closest("form").submit();                        }                    });        });    </script></block>